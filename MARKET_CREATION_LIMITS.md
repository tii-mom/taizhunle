# é¢„æµ‹å¸‚åœºåˆ›å»ºè´¨æŠ¼è§„åˆ™

## ğŸ” æ¦‚è§ˆ
å¤ªå‡†äº†å°†é¢„æµ‹åˆ›å»ºä»â€œ100 TAI åˆ›å»ºè´¹â€å‡çº§ä¸ºâ€œæŒ‰ç­‰çº§è´¨æŠ¼ + å¥–æ±  1% é™ªå®¡å¥–åŠ±â€ã€‚
- **è´¨æŠ¼**ï¼šåˆ›å»ºè€…æŒ‰é™ªå®¡ç§¯åˆ†ç­‰çº§é”å®š 1,000 ~ 20,000 TAIï¼Œé¢„æµ‹ç»“ç®—åè‡ªåŠ¨é€€å›ã€‚
- **å¥–åŠ±**ï¼šé™ªå®¡å¥–åŠ± = å®æ—¶å¥–æ± çš„ 1%ï¼Œå‘ç”Ÿç”³è¯‰æˆ–æ¶æ„è¡Œä¸ºæ—¶æ‰æ‰£å‡è´¨æŠ¼ã€‚
- **å†·å´**ï¼šç­‰çº§è¶Šé«˜å†·å´è¶ŠçŸ­ï¼Œé¼“åŠ±é™ªå®¡å‘˜æŒç»­å‚ä¸ã€‚

---

## ğŸ§® ç­‰çº§ â†” è´¨æŠ¼ â†” å†·å´

| ç§¯åˆ†èŒƒå›´ | ç§°å· | éœ€è´¨æŠ¼ (TAI) | åˆ›å»ºå†·å´ | æ¯æ—¥é™ªå®¡ä¸Šé™ |
|----------|------|---------------|-----------|---------------|
| æ™®é€šç”¨æˆ· | - | 1,000 | 360 å°æ—¶ | ä¸å¯é™ªå®¡ |
| 0-99     | æ­¦æ—æ–°ä¸ (Lv.1) | 1,000 | 72 å°æ—¶ | 3 æ¬¡ |
| 100-399  | é£å°˜å¥‡ä¾  (Lv.2) | 5,000 | 48 å°æ—¶ | 9 æ¬¡ |
| 400-999  | åœ°ç‹±åˆ¤å®˜ (Lv.3) | 10,000 | 24 å°æ—¶ | 30 æ¬¡ |
| 1000+    | å¤©ä¸Šå¤©ä¸‹å¤©åœ°æ— åŒ (Lv.4) | 20,000 | 6 å°æ—¶ | æ— é™åˆ¶ |

- è´¨æŠ¼åœ¨é¢„æµ‹ç»“æŸåè§£é”ã€‚
- ä»¥ä¸‹åœºæ™¯æ‰£å‡è´¨æŠ¼ï¼šç”³è¯‰æˆç«‹ï¼ˆ-50%ï¼‰ã€è¢«åˆ¤æ¶æ„ï¼ˆ-100%ï¼‰ã€è¶…æ—¶æœªç»“ç®—ï¼ˆ-20%ï¼‰ã€‚

---

## âš™ï¸ åˆ›å»ºæµç¨‹

```
1. è·å–ç”¨æˆ·ç§¯åˆ†/é™ªå®¡çŠ¶æ€
2. é€šè¿‡ getCreationStakeRequirement(points) è®¡ç®— { stake, cooldown }
3. æ ¡éªŒè·ç¦»ä¸Šæ¬¡åˆ›å»ºçš„æ—¶é—´ â‰¥ cooldown
4. æ ¡éªŒä½™é¢ â‰¥ stake
5. é”å®š stakeï¼ˆé“¾ä¸Šæˆ–è´¦é¢ï¼‰
6. å†™å…¥é¢„æµ‹è®°å½•ï¼Œæ ‡è®° creator_fee = stake
7. é¢„æµ‹ç»“æŸï¼šæ­£å¸¸è¿”è¿˜ stakeï¼›è‹¥ç”³è¯‰æˆ–æ¶æ„åˆ™æŒ‰è§„åˆ™æ‰£å‡
```

### æ ¸å¿ƒä»£ç ç‰‡æ®µ

```ts
export function getCreationStakeRequirement(points: number) {
  if (points >= 1000) return { stake: 20_000, cooldownHours: 6 };
  if (points >= 400) return { stake: 10_000, cooldownHours: 24 };
  if (points >= 100) return { stake: 5_000, cooldownHours: 48 };
  return { stake: 1_000, cooldownHours: 72 };
}
```

```ts
export function mapPrediction(row, bets = []) {
  const totalPool = toNumber(row.total_pool) || toNumber(row.yes_pool) + toNumber(row.no_pool);
  const creatorStakeTai = parseStakeRange(row).creatorStakeTai ?? Math.max(1_000, toNumber(row.creator_fee));
  return {
    ...,
    creatorStakeTai,
    stakeCooldownHours: parseStakeRange(row).stakeCooldownHours ?? 72,
    jurorRewardTai: Math.max(0, Math.round(totalPool * 0.01)),
  };
}
```

---

## ğŸ“¡ API ç»“æ„

### GET `/api/markets/creation/permission`
```json
{
  "walletAddress": "EQ...",
  "canCreate": true,
  "points": 420,
  "isJuror": true,
  "intervalHours": 24,
  "hoursRemaining": 0,
  "requiredStakeTai": 10000,
  "stakeCooldownHours": 24,
  "nextAvailableTime": null,
  "lastCreatedAt": "2025-03-01T10:00:00Z"
}
```

### POST `/api/markets`
```json
{
  "title": "BTC price above $150k before Dec 2025?",
  "closesAt": "2025-12-01T00:00:00Z",
  "minStake": 1000,
  "maxStake": 200000,
  "creatorWallet": "EQ...",
  "creatorStakeTai": 10000
}
```

åç«¯å°† `creatorStakeTai` å†™å…¥ `predictions.creator_fee`ï¼ŒåŒæ—¶åœ¨ `admin_notes` è®°å½• `stakeCooldownHours`ï¼Œé¢„æµ‹åˆ›å»ºæˆåŠŸåå³ç®—åˆ›å»ºä¸€æ¬¡ï¼Œæ›´æ–° `last_market_created_at`ã€‚

---

## ğŸ–¥ï¸ UI æŒ‡å—

1. **åˆ›å»ºæŒ‰é’®**ï¼šæœªè¿æ¥æ—¶æç¤ºâ€œè¿æ¥ TON é’±åŒ…â€ï¼Œå·²è¿æ¥æ˜¾ç¤ºâ€œéœ€è´¨æŠ¼ X TAI / å†·å´ Y å°æ—¶â€ã€‚
2. **åˆ›å»ºè¡¨å•**ï¼šå±•ç¤ºè´¨æŠ¼å¡ç‰‡ï¼ˆé‡‘é¢ã€å†·å´ã€æ‰£å‡è§„åˆ™ï¼‰ï¼Œç§»é™¤é™ªå®¡å¥–åŠ±è¾“å…¥æ¡†ã€‚
3. **Market å¡ç‰‡**ï¼š
   - ä¸»ä½“ä¿¡æ¯ï¼šå¥–æ± ã€å®æ—¶èµ”ç‡ã€ç›®æ ‡ã€‚
  - å³ä¾§é¢æ¿ï¼šåˆ›å»ºè´¨æŠ¼ï¼ˆCreator Stakeï¼‰ä¸å€’è®¡æ—¶ã€‚
  - å¾½ç« ï¼šé™ªå®¡å¥–åŠ± = å¥–æ±  1%ã€‚
4. **è¯¦æƒ…é¡µ**ï¼šåœ¨ç³»ç»Ÿä¿¡æ¯æ¨¡å—å±•ç¤ºâ€œåˆ›å»ºè´¨æŠ¼ + å†·å´ + é™ªå®¡å¥–åŠ±â€ã€‚

---

## ğŸ“„ ç”³è¯‰ä¸æ‰£å‡è§„åˆ™

| åœºæ™¯ | æ‰£å‡æ¯”ä¾‹ | è¯´æ˜ |
|------|----------|------|
| ç”³è¯‰æˆç«‹ | 50% | èµ”ä»˜ç”³è¯‰æ–¹ï¼Œå‰©ä½™è¿”è¿˜åˆ›å»ºè€… |
| æ¶æ„/æ— æ•ˆé¢„æµ‹ | 100% | è´¨æŠ¼å…¨éƒ¨åˆ’å…¥å¹³å°é£é™©åŸºé‡‘ |
| è¶…æ—¶æœªç»“ç®— | 20% | ä¿éšœç”¨æˆ·æƒç›Šï¼Œå‰©ä½™è¿”è¿˜ |

æ‰£å‡ç»“æœè¿›å…¥ DAO æ± ï¼Œç”¨äºè¡¥å¿é™ªå®¡å‘˜/å—å®³ç”¨æˆ·ã€‚

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

- å•å…ƒæµ‹è¯•ï¼š`getCreationStakeRequirement`ã€`mapPrediction`ã€mock æœåŠ¡ `createMarketDraft` / `placeBet`ã€‚ 
- é›†æˆæµ‹è¯•ï¼šæ¨¡æ‹Ÿåˆ›å»º â†’ ä¸‹æ³¨ â†’ ç»“ç®—æµç¨‹ï¼ŒéªŒè¯è´¨æŠ¼æ‰£å‡ä¸å¥–åŠ±æ›´æ–°ã€‚
- å›å½’æµ‹è¯•ï¼šç¡®ä¿æ—§ API å…¼å®¹ï¼ˆå‰ç«¯ã€è„šæœ¬ï¼‰ã€‚

---

## âœ… éªŒæ”¶æ ‡å‡†
1. `createMarketDraft` ä»…æ¥å— `creatorStakeTai`ï¼Œå¥–åŠ±å§‹ç»ˆä¸ºå¥–æ±  1%ã€‚
2. æƒé™æ¥å£è¿”å› `requiredStakeTai` å’Œ `stakeCooldownHours`ã€‚
3. å‰ç«¯ç•Œé¢å±•ç¤ºè´¨æŠ¼ä¿¡æ¯ã€å†·å´ä¸é™ªå®¡å¥–åŠ±ï¼Œæ—  100 TAI æ–‡æ¡ˆã€‚
4. æ–‡æ¡£ã€è®¡åˆ’ã€å›½é™…åŒ–æ–‡æœ¬ä¸ä»£ç ä¸€è‡´ã€‚
